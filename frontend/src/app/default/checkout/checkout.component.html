<form class="container mt-5"  [formGroup]="onboardingForm">
  <h2 class="mb-4">Checkout</h2>
  <div class="step-form" formGroupName="shipping" *ngIf="currentStep === 1">
    <h4>Shipping Address</h4>
    <div class="form-group">
      <label for="firstName">First Name</label>
      <input type="text" class="form-control" id="firstName" formControlName="firstName" required>
    </div>
    <div class="form-group">
      <label for="lastName">Last Name</label>
      <input type="text" class="form-control" id="lastName" formControlName="lastName" required>
    </div>
    <div class="form-group">
      <label for="streetAddress">Street Address</label>
      <input type="text" class="form-control" id="streetAddress" formControlName="streetAddress" required>
    </div>
    <div class="form-group">
      <label for="city">City</label>
      <input type="text" class="form-control" id="city" formControlName="city" required>
    </div>
    <div class="form-group">
      <label for="state">State</label>
      <input type="text" class="form-control" id="state" formControlName="state" required>
    </div>
    <div class="form-group">
      <label for="postalCode">Postal Code</label>
      <input type="text" class="form-control" id="postalCode" formControlName="postalCode" required>
    </div>
    <div class="form-group">
      <label for="country">Country</label>
      <input type="text" class="form-control" id="country" formControlName="country" required>
    </div>
    <div class="form-group">
      <label for="phoneNumber">Phone Number</label>
      <input type="text" class="form-control" id="phoneNumber" formControlName="phoneNumber" required>
    </div>
    <div class="d-flex justify-content-end">
      <button class="btn btn-primary next-step" (click)="nextStep()">Next</button>
    </div>
  </div>

  <div class="step-form" formGroupName="payment" *ngIf="currentStep === 2">
    <h4>Payment Method</h4>
    <div class="form-group">
      <label for="creditCardNumber">Credit Card Number</label>
      <input type="text" class="form-control" id="creditCardNumber" formControlName="creditCardNumber" required>
    </div>
    <div class="form-group">
      <label for="expirationDate">Expiration Date</label>
      <input type="date" class="form-control" id="expirationDate" formControlName="expirationDate" required>
    </div>
    <div class="form-group">
      <label for="cvv">CVV</label>
      <input type="text" class="form-control" id="cvv" formControlName="cvv" required>
    </div>
    <div class="form-group">
      <label for="billingAddress">Billing Address</label>
      <input type="text" class="form-control" id="billingAddress" formControlName="billingAddress" required>
    </div>
    <div class="d-flex justify-content-between">
      <button class="btn btn-primary prev-step" (click)="prevStep()">Previous</button>
      <button class="btn btn-primary next-step" (click)="nextStep()">Next</button>
    </div>
  </div>

  <div class="step-form" formGroupName="items" *ngIf="currentStep === 3">
    <h4>Items</h4>
    <article class="row gy-3 mb-4" *ngFor="let item of cartItems">
      <div class="col-8">
        <figure class="itemside me-12">
          <div class="aside m-1"><img src="/api/{{item.product.imgpath}}" class="img-sm img-thumbnail"></div>
          <figcaption class="info">
            <a href="#" class="title">{{item.product.name}}</a>
            <p class="text-muted"> {{item.product.brand}}, {{item.product.category}} </p>
          </figcaption>
        </figure>
      </div>

      <div class="col-4">
        <div class="price-wrap lh-sm">
          <var class="price h5"></var> {{ item.product.price*item.quantity | currency:'MAD':'symbol-narrow':'.0-0':'fr'}} <br>
          <small class="text-muted"> {{ item.product.price | currency:'MAD':'symbol-narrow':'.0-0':'fr'}} / per item </small>
        </div>
      </div>
    </article>

    <h4>Shipping</h4>
    <div class="form-group">
      <label for="shippingMethod">Choose Shipping Method</label>
      <select class="form-control" id="shippingMethod" formControlName="shippingMethod">
        <option value="" disabled selected>Choose Shipping Method</option>
        <option value="standard">Standard Shipping: {{ calculateTotal()*0.05 | currency:'MAD':'symbol-narrow':'.0-0':'fr'}}</option>
        <option value="express">Express Shipping:  {{ calculateTotal()*0.15 | currency:'MAD':'symbol-narrow':'.0-0':'fr'}}</option>
      </select>
    </div>

    <h4>Total</h4>
    <p>Order Total:  {{ calculateTotal() | currency:'MAD':'symbol-narrow':'.0-0':'fr'}}</p>
    <div class="d-flex justify-content-between">
      <button class="btn btn-primary" (click)="prevStep()">Previous</button>
      <button class="btn btn-success" (click)="placeOrder()">Place Order</button>
    </div>
  </div>

  <div *ngIf="submitted" class="text-danger font-weight-bold text-center">
    <div >***  Please fill all fields ***</div>
</div>
</form>
