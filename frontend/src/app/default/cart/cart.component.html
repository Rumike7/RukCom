<aside class="control-sidebar control-sidebar-light w-50 border-2" style="position:fixed;">
  <div class="container p-3 m-2 overflow-auto vh-100">
    <div class="row">
      <div class="col-12 p-1">
        <div class="card" *ngIf="cartItems.length>0;else noCartItem">
        <div class="card-body">
          <h4 class="text-dart row mb-4">Your shopping cart</h4>
          <article class="row gy-3 mb-4" *ngFor="let item of cartItems">
            <div class="col-5">
              <figure class="itemside me-12">
                <div class="aside m-1"><img src="/api/{{item.product.imgpath}}" class="img-sm img-thumbnail"></div>
                <figcaption class="info">
                  <a href="#" class="title">{{item.product.name}}</a>
                  <p class="text-muted"> {{item.product.brand}}, {{item.product.category}} </p>
                </figcaption>
              </figure>
            </div>
            <div class="col-3">
              <div class="row justify-content-around">
                <button type="button" class="btn rounded-circle btn-secondary col-1 " (click)="updateCartItem(item,item.quantity-1)">-</button>
                <input type="number" class="form-control col-5" [(ngModel)]="item.quantity" (change)="updateCartItem(item,item.quantity)">
                <button type="button" class="btn rounded-circle btn-secondary col-1 " (click)="updateCartItem(item,item.quantity+1)">+</button>
              </div>
            </div>
            <div class="col-3">
              <div class="price-wrap lh-sm">
                <var class="price h5"></var> {{ item.product.price*item.quantity | currency:'MAD':'symbol-narrow':'.0-0':'fr'}} <br>
                <small class="text-muted"> {{ item.product.price | currency:'MAD':'symbol-narrow':'.0-0':'fr'}} / per item </small>
              </div>
            </div>
            <div class="col-1">
              <div class="float-lg-end">
                <a (click)="removeFromCart(item)" class="btn btn-light text-danger">
                  <i class="fas fa-trash" ></i>
                </a>
              </div>
            </div>
          </article>
        </div>
        <div class="card-footer border-top">
          <p><i class="me-2 text-muted fa-lg fa fa-truck"></i> Free Delivery within 1-2 weeks</p>
        </div>

        </div>
        <ng-template #noCartItem>
            <div style="min-height: 300px" class="h-100 d-flex align-items-center justify-content-center">
              <div>
                <div>No Product added to your shopping cart</div>
                <div class="d-flex justify-content-center">
                  <button type="button" class="btn btn-primary" (click)="changeVisibilityCartAndRouteToHome()">See products</button>
                </div>

              </div>
            </div>
        </ng-template>

      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="row justify-content-between">
          <div class="col-5">Total price:</div>
          <div class="col-5"> {{ calculateTotal() | currency:'MAD':'symbol-narrow':'.0-0':'fr'}}</div>

          <div class="col-5">Discount:</div>
          <div class="col-5 text-success">{{ calculateDiscount() | currency:'MAD':'symbol-narrow':'.0-0':'fr'}} </div>

          <div class="col-5">Total:</div>
          <div class="col-5 text-dark h5"> {{ calculateTotal()-calculateDiscount() | currency:'MAD':'symbol-narrow':'.0-0':'fr'}}</div>
        </div>
        <div class="d-grid gap-2 my-3">
          <a (click)="purchase()" class="btn btn-success w-100"> Make Purchase </a>
          <a (click)="changeVisibilityCartAndRouteToHome()" class="btn btn-light w-100"> Back to shop </a>
        </div>
      </div>
    </div>
  </div>
</aside>
